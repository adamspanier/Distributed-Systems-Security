==== Blockchain & Fingerprinting Environment Security Test ====
Testing network: ics (172.20.0.0/16)
Started at: 2025-04-24 13:35:34
========================================
Checking dependencies...
Executing command: which nmap
Command exit code: 0
Found nmap: /usr/bin/nmap
Executing command: which openssl
Command exit code: 0
Found openssl: /usr/bin/openssl
Executing command: which curl
Command exit code: 0
Found curl: /usr/bin/curl
pymodbus is installed.
paho-mqtt is installed.
pycomm3 is installed.

--- Testing PLC1 (172.20.0.9) ---
Testing network availability for PLC1 (172.20.0.9)
--- Testing PLC2 (172.20.0.5) ---

Testing network availability for PLC2 (172.20.0.5)
--- Testing PLC3 (172.20.0.6) ---
Checking if the host 172.20.0.9 is upTesting network availability for PLC3 (172.20.0.6)
Checking if the host 172.20.0.6 is up
Executing command: ping -c 1 -W 1 172.20.0.6


Executing command: ping -c 1 -W 1 172.20.0.9
Checking if the host 172.20.0.5 is up
Executing command: ping -c 1 -W 1 172.20.0.5

--- Testing MQTT_Broker (172.20.0.8) ---
Testing network availability for MQTT_Broker (172.20.0.8)
--- Testing InfluxDB (172.20.0.7) ---

Testing network availability for InfluxDB (172.20.0.7)
Checking if the host 172.20.0.7 is up
Executing command: ping -c 1 -W 1 172.20.0.7

--- Testing Grafana (172.20.0.11) ---
Checking if the host 172.20.0.8 is up
Executing command: ping -c 1 -W 1 172.20.0.8
Testing network availability for Grafana (172.20.0.11)
Checking if the host 172.20.0.11 is up
Executing command: ping -c 1 -W 1 172.20.0.11

--- Testing SCADA (172.20.0.2) ---
Testing network availability for SCADA (172.20.0.2)
--- Testing Blockchain (172.20.0.10) ---
Testing network availability for Blockchain (172.20.0.10)
Checking if the host 172.20.0.2 is up
Executing command: ping -c 1 -W 1 172.20.0.2
--- Testing Fingerprinting (172.20.0.3) ---

Checking if the host 172.20.0.10 is up
Testing network availability for Fingerprinting (172.20.0.3)
Executing command: ping -c 1 -W 1 172.20.0.10


--- Testing Data_Populator (172.20.0.4) ---
Checking if the host 172.20.0.3 is up
Executing command: ping -c 1 -W 1 172.20.0.3Testing network availability for Data_Populator (172.20.0.4)
Command exit code: 0
2025-04-24 13:35:34 [PASS] MQTT_Broker - Network AvailabilityCommand exit code: 0
Checking if the host 172.20.0.4 is upCommand exit code: 0

Executing command: ping -c 1 -W 1 172.20.0.4

Command exit code: 0
Command exit code: 0
  Details: IP: 172.20.0.8
Testing port availability for MQTT_Broker (172.20.0.8)2025-04-24 13:35:34 [PASS] InfluxDB - Network Availability

Checking for open ports on 172.20.0.8: [1883, 8883] (UDP: False)
Command exit code: 0
  Details: IP: 172.20.0.7
Testing port availability for InfluxDB (172.20.0.7)
Checking for open ports on 172.20.0.7: [8086] (UDP: False)
2025-04-24 13:35:34 [PASS] Grafana - Network Availability
  Details: IP: 172.20.0.11
Testing port availability for Grafana (172.20.0.11)
Checking for open ports on 172.20.0.11: [3000] (UDP: False)
TCP port 3000 is open on 172.20.0.11
2025-04-24 13:35:34 [PASS] Grafana - TCP Port Accessibility
  Details: Expected: [3000], Open: [3000]
Testing Grafana security for 172.20.0.11:3000
Checking for open ports on 172.20.0.11: [3000] (UDP: False)
TCP port 3000 is open on 172.20.0.11
Executing command: curl -s -k -o /dev/null -w '%{http_code}' https://172.20.0.11:3000/login
Command exit code: 0
2025-04-24 13:35:34 [PASS] PLC2 - Network Availability
  Details: IP: 172.20.0.5
Command exit code: 0Testing port availability for PLC2 (172.20.0.5)2025-04-24 13:35:34 [PASS] PLC1 - Network Availability
  Details: IP: 172.20.0.9
Testing port availability for PLC1 (172.20.0.9)
Checking for open ports on 172.20.0.9: [502, 44818] (UDP: False)
TCP port 502 is open on 172.20.0.9
2025-04-24 13:35:34 [FAIL] PLC1 - TCP Port Accessibility
  Details: Expected: [502, 44818], Open: [502]
Testing PLC Modbus security for PLC1 (172.20.0.9:502)
Checking for open ports on 172.20.0.9: [502] (UDP: False)
TCP port 502 is open on 172.20.0.9
TCP port 8086 is open on 172.20.0.7

Checking for open ports on 172.20.0.5: [502, 44818] (UDP: False)
Command exit code: 0
2025-04-24 13:35:34 [PASS] Blockchain - Network Availability
  Details: IP: 172.20.0.10
2025-04-24 13:35:34 [PASS] PLC3 - Network Availability
  Details: IP: 172.20.0.6
Testing port availability for PLC3 (172.20.0.6)
Checking for open ports on 172.20.0.6: [502, 44818] (UDP: False)
TCP port 502 is open on 172.20.0.6
2025-04-24 13:35:34 [PASS] SCADA - Network Availability
  Details: IP: 172.20.0.2

Testing port availability for SCADA (172.20.0.2)
Checking for open ports on 172.20.0.2: [80, 8080] (UDP: False)
Testing port availability for Blockchain (172.20.0.10)
2025-04-24 13:35:34 [PASS] Fingerprinting - Network Availability
  Details: IP: 172.20.0.3
Testing port availability for Fingerprinting (172.20.0.3)
Checking for open ports on 172.20.0.3: [1066] (UDP: False)
TCP port 1066 is open on 172.20.0.3
2025-04-24 13:35:34 [PASS] Fingerprinting - TCP Port Accessibility
  Details: Expected: [1066], Open: [1066]
Testing fingerprinting server security for 172.20.0.3:1066
Checking for open ports on 172.20.0.3: [1066] (UDP: False)
TCP port 1066 is open on 172.20.0.3
Executing command: curl -s -o /dev/null -w '%{http_code}' http://172.20.0.3:1066/

2025-04-24 13:35:34 [FAIL] SCADA - TCP Port AccessibilityChecking for open ports on 172.20.0.10: [1065] (UDP: False)
TCP port 1065 is open on 172.20.0.10
TCP port 502 is open on 172.20.0.5

  Details: Expected: [80, 8080], Open: []
Testing SCADA security for 172.20.0.2:8080
Checking for open ports on 172.20.0.2: [80] (UDP: False)
Checking for open ports on 172.20.0.2: [8080] (UDP: False)
2025-04-24 13:35:34 [FAIL] SCADA - Connectivity
  Details: Ports not accessible
2025-04-24 13:35:34 [PASS] InfluxDB - TCP Port Accessibility
  Details: Expected: [8086], Open: [8086]
Testing InfluxDB security for 172.20.0.7:8086
Checking for open ports on 172.20.0.7: [8086] (UDP: False)
TCP port 8086 is open on 172.20.0.7
Executing command: curl -s -o /dev/null -w '%{http_code}' http://172.20.0.7:8086/ping
2025-04-24 13:35:34 [FAIL] PLC2 - TCP Port Accessibility
  Details: Expected: [502, 44818], Open: [502]
Testing PLC Modbus security for PLC2 (172.20.0.5:502)
Checking for open ports on 172.20.0.5: [502] (UDP: False)
2025-04-24 13:35:34 [FAIL] PLC3 - TCP Port Accessibility
  Details: Expected: [502, 44818], Open: [502]
Testing PLC Modbus security for PLC3 (172.20.0.6:502)
Checking for open ports on 172.20.0.6: [502] (UDP: False)
TCP port 502 is open on 172.20.0.6
TCP port 502 is open on 172.20.0.5
Command exit code: 0
2025-04-24 13:35:34 [PASS] Data_Populator - Network Availability
  Details: IP: 172.20.0.4
Testing port availability for Data_Populator (172.20.0.4)
2025-04-24 13:35:34 [INFO] Data_Populator - TCP Port Accessibility
  Details: No ports defined for component
2025-04-24 13:35:34 [FAIL] MQTT_Broker - TCP Port Accessibility
  Details: Expected: [1883, 8883], Open: []
Testing MQTT security for 172.20.0.8:1883
Checking for open ports on 172.20.0.8: [1883] (UDP: False)
Checking for open ports on 172.20.0.8: [8883] (UDP: False)
2025-04-24 13:35:34 [FAIL] MQTT_Broker - Connectivity
  Details: MQTT ports not accessible
2025-04-24 13:35:34 [PASS] Blockchain - TCP Port Accessibility
  Details: Expected: [1065], Open: [1065]
Testing blockchain server security for 172.20.0.10:1065
Checking for open ports on 172.20.0.10: [1065] (UDP: False)
TCP port 1065 is open on 172.20.0.10
Executing command: curl -s -o /dev/null -w '%{http_code}' http://172.20.0.10:1065/
WARNING: pymodbus library not installed
2025-04-24 13:35:34 [INFO] PLC3 - Modbus Security
  Details: pymodbus library not installed
Testing EtherNet/IP security for PLC3 (172.20.0.6:44818)
Checking for open ports on 172.20.0.6: [44818] (UDP: False)
2025-04-24 13:35:34 [INFO] PLC3 - EtherNet/IP Security
  Details: Port not available
WARNING: pymodbus library not installed
2025-04-24 13:35:34 [INFO] PLC2 - Modbus Security
  Details: pymodbus library not installed
Testing EtherNet/IP security for PLC2 (172.20.0.5:44818)
Checking for open ports on 172.20.0.5: [44818] (UDP: False)
2025-04-24 13:35:34 [INFO] PLC2 - EtherNet/IP Security
  Details: Port not available
WARNING: pymodbus library not installed
2025-04-24 13:35:34 [INFO] PLC1 - Modbus Security
  Details: pymodbus library not installed
Testing EtherNet/IP security for PLC1 (172.20.0.9:44818)
Checking for open ports on 172.20.0.9: [44818] (UDP: False)
2025-04-24 13:35:34 [INFO] PLC1 - EtherNet/IP Security
  Details: Port not available
Command exit code: 0
2025-04-24 13:35:34 [INFO] InfluxDB - API Accessibility
  Details: InfluxDB ping endpoint accessible
Attempting to query InfluxDB without authentication
Executing command: curl -s -o /dev/null -w '%{http_code}' http://172.20.0.7:8086/query --data-urlencode 'q=SHOW DATABASES'
Command exit code: 35
2025-04-24 13:35:34 [FAIL] Grafana - HTTPS
  Details: Grafana does not use HTTPS
Testing Grafana default credentials
Executing command: curl -s -o /dev/null -w '%{http_code}' -X POST -H 'Content-Type: application/json' -d '{"username":"admin","password":"admin"}' http://172.20.0.11:3000/login
Command exit code: 0
2025-04-24 13:35:34 [PASS] InfluxDB - Authentication
  Details: Authentication required for queries
Executing command: curl -s -I http://172.20.0.7:8086/query
Command exit code: 0
2025-04-24 13:35:34 [PASS] Grafana - Default Credentials
  Details: Default admin/admin credentials rejected
Testing Grafana API exposure
Executing command: curl -s -o /dev/null -w '%{http_code}' http://172.20.0.11:3000/api/health
Command exit code: 0
2025-04-24 13:35:34 [WARN] InfluxDB - Authentication Headers
  Details: No WWW-Authenticate header found
Command exit code: 0
2025-04-24 13:35:34 [INFO] Grafana - API Exposure
  Details: Health API endpoint accessible
Executing command: curl -s -I http://172.20.0.11:3000
Command exit code: 0
2025-04-24 13:35:34 [WARN] Grafana - Security Headers
  Details: Missing security headers: X-XSS-Protection, Content-Security-Policy, Strict-Transport-Security
Command timed out after 10 seconds
Attempting to query fingerprinting server
Executing command: curl -s -X GET http://172.20.0.3:1066/fingerprints
Command timed out after 10 seconds
Attempting to query blockchain server
Executing command: curl -s -X GET http://172.20.0.10:1065/blockchain
Command timed out after 10 seconds
2025-04-24 13:35:54 [INFO] Fingerprinting - Data Access
  Details: Fingerprinting data access response received
Executing command: curl -s -X POST -H 'Content-Type: application/json' -d '{"device":"test_device","fingerprint":"test_security_fingerprint"}' http://172.20.0.3:1066/submit
Command timed out after 10 seconds
2025-04-24 13:35:54 [INFO] Blockchain - Data Access
  Details: Blockchain data access response received
Executing command: curl -s -X POST -H 'Content-Type: application/json' -d '{"data":"test_security_data","timestamp":"2025-04-24T13:35:54.521137"}' http://172.20.0.10:1065/add
Command timed out after 10 seconds
2025-04-24 13:36:04 [INFO] Fingerprinting - Data Write Access
  Details: Response: 
Command timed out after 10 seconds
2025-04-24 13:36:04 [INFO] Blockchain - Data Write Access
  Details: Response: 

--- Network-wide tests ---
Testing network segmentation for defined component IPs only
Checking network presence of 172.20.0.9
Executing command: ping -c 1 -W 1 172.20.0.9
Command exit code: 0
Found active host at 172.20.0.9
Checking network presence of 172.20.0.5
Executing command: ping -c 1 -W 1 172.20.0.5
Command exit code: 0
Found active host at 172.20.0.5
Checking network presence of 172.20.0.6
Executing command: ping -c 1 -W 1 172.20.0.6
Command exit code: 0
Found active host at 172.20.0.6
Checking network presence of 172.20.0.8
Executing command: ping -c 1 -W 1 172.20.0.8
Command exit code: 0
Found active host at 172.20.0.8
Checking network presence of 172.20.0.7
Executing command: ping -c 1 -W 1 172.20.0.7
Command exit code: 0
Found active host at 172.20.0.7
Checking network presence of 172.20.0.11
Executing command: ping -c 1 -W 1 172.20.0.11
Command exit code: 0
Found active host at 172.20.0.11
Checking network presence of 172.20.0.2
Executing command: ping -c 1 -W 1 172.20.0.2
Command exit code: 0
Found active host at 172.20.0.2
Checking network presence of 172.20.0.10
Executing command: ping -c 1 -W 1 172.20.0.10
Command exit code: 0
Found active host at 172.20.0.10
Checking network presence of 172.20.0.3
Executing command: ping -c 1 -W 1 172.20.0.3
Command exit code: 0
Found active host at 172.20.0.3
Checking network presence of 172.20.0.4
Executing command: ping -c 1 -W 1 172.20.0.4
Command exit code: 0
Found active host at 172.20.0.4
2025-04-24 13:36:04 [PASS] Network - Network Segmentation
  Details: All expected devices found: 10/10
Skipping full subnet scan for unexpected devices
2025-04-24 13:36:04 [INFO] Network - Network Segmentation
  Details: Skipping full subnet scan for unexpected devices
Performing version detection on defined component IPs
Starting version detection on 10 IPs
2025-04-24 13:36:04 [INFO] Network - Vulnerability Scan
  Details: Performing limited version detection instead of full vulnerability scan
Executing command: nmap -sV --version-intensity 2 --max-retries 1 --host-timeout 10s 172.20.0.9 172.20.0.5 172.20.0.6 172.20.0.8 172.20.0.7 172.20.0.11 172.20.0.2 172.20.0.10 172.20.0.3 172.20.0.4 -oX /tmp/nmap_version_results.xml
Command exit code: 0
2025-04-24 13:36:16 [INFO] Network - Version Detection
  Details: Scan completed on 10 IPs. Results in /tmp/nmap_version_results.xml

==== Testing Complete ====
Generating final report...
Generating security assessment report

==== Security Assessment Summary ====
Total Tests: 43
PASS: 17
WARN: 2
FAIL: 8
INFO: 9
SKIP: 7

CRITICAL FINDINGS:
- PLC1: TCP Port Accessibility - Expected: [502, 44818], Open: [502]
- SCADA: TCP Port Accessibility - Expected: [80, 8080], Open: []
- SCADA: Connectivity - Ports not accessible
- PLC2: TCP Port Accessibility - Expected: [502, 44818], Open: [502]
- PLC3: TCP Port Accessibility - Expected: [502, 44818], Open: [502]
- MQTT_Broker: TCP Port Accessibility - Expected: [1883, 8883], Open: []
- MQTT_Broker: Connectivity - MQTT ports not accessible
- Grafana: HTTPS - Grafana does not use HTTPS

