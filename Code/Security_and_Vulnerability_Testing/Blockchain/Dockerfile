FROM python:3.9-slim

# Set working directory
WORKDIR /app

# Install system dependencies
RUN apt-get update && apt-get install -y \
    nmap \
    openssl \
    curl \
    iputils-ping \
    && rm -rf /var/lib/apt/lists/*

# Copy the security testing script
COPY BlockchainTest.py /app/BlockchainTest.py

# Make the script executable
RUN chmod +x /app/BlockchainTest.py

# Install Python dependencies
RUN pip install --no-cache-dir \
    pymodbus \
    paho-mqtt \
    pycomm3

# Set environment variables
ENV PYTHONUNBUFFERED=1

# Define an output volume for the report
VOLUME /app/reports

# Command to run the script
ENTRYPOINT ["python", "/app/BlockchainTest.py"]