# Security and Vulnerability Testing

The following scripts were created to be run against their respective environments to enumerate the vulnerabilities present within them. They are available in full in the code folder.

## Unencrypted Environment

```python
#!/usr/bin/env python3
"""
Industrial Network Security Test Script
---------------------------------------
This script tests the security of a dockerized industrial network environment.
Network: no_crypto_env_industrial_no_crypto
Subnet: 172.18.0.0/16
"""

import subprocess
import socket
import threading
import time
import sys
import os
import json
from datetime import datetime

# Define the network components
NETWORK_COMPONENTS = {
    "PLC1": {"name": "plc1_no_crypto", "ip": "172.18.0.8", "ports": [502, 8080]},
    "PLC2": {"name": "plc2_no_crypto", "ip": "172.18.0.2", "ports": [502, 8080]},
    "PLC3": {"name": "plc3_no_crypto", "ip": "172.18.0.7", "ports": [502, 8080]},
    "MQTT_Broker": {"name": "mqtt-broker-no-crypto", "ip": "172.18.0.4", "ports": [1883]},
    "InfluxDB": {"name": "influxdb-no-crypto", "ip": "172.18.0.5", "ports": [8086]},
    "Grafana": {"name": "grafana-no-crypto", "ip": "172.18.0.9", "ports": [3000]},
    "SCADA": {"name": "scada-no-crypto", "ip": "172.18.0.3", "ports": [8088]}
}

SUBNET = "172.18.0.0/16"
RESULTS = []
lock = threading.Lock()

def log_result(component, test_name, result, details=None):
    """Log a test result with thread safety"""
    with lock:
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        RESULTS.append({
            "timestamp": timestamp,
            "component": component,
            "test": test_name,
            "result": result,
            "details": details
        })
        status = "[\033[92mPASS\033[0m]" if result == "PASS" else "[\033[91mFAIL\033[0m]"
        print(f"{timestamp} {status} {component} - {test_name}", flush=True)
        if details:
            print(f"  Details: {details}", flush=True)
        sys.stdout.flush()

# Additional functions omitted for brevity
# See full script for complete implementation
```

## Encrypted Environment

```python
#!/usr/bin/env python3
"""
Encrypted Industrial Network Security Test Script
------------------------------------------------
This script tests the security of a dockerized industrial network environment.
Network: encrypted_env_industrial_net
Subnet: 172.19.0.0/16

Docker-optimized version with improved logging and progress tracking
"""

import subprocess
import socket
import threading
import time
import sys
import os
import json
import traceback
from datetime import datetime

# Define the network components
NETWORK_COMPONENTS = {
    "PLC1": {"name": "plc1", "ip": "172.19.0.10", "ports": [5502, 8080]},
    "PLC2": {"name": "plc2", "ip": "172.19.0.11", "ports": [5502, 8080]},
    "PLC3": {"name": "plc3", "ip": "172.19.0.8", "ports": [5502, 8080]},
    "MQTT_Broker": {"name": "mqtt-broker", "ip": "172.19.0.6", "ports": [8883], "tls": True},
    "InfluxDB": {"name": "influxdb-secure", "ip": "172.19.0.5", "ports": [8097], "tls": True},
    "Grafana": {"name": "grafana-secure", "ip": "172.19.0.9", "ports": [3000]},
    "SCADA": {"name": "scada", "ip": "172.19.0.7", "ports": [8088]},
    "Modbus_TLS_Gateway": {"name": "modbus-tls", "ip": "172.19.0.4", "ports": [8502], "tls": True},
    "VPN_Gateway": {"name": "vpn", "ip": "172.19.0.3", "ports": [51820], "udp": True},
    "OPC_UA_Server": {"name": "opc-ua", "ip": "172.19.0.2", "ports": [4840]}
}

SUBNET = "172.19.0.0/16"
RESULTS = []
lock = threading.Lock()
threads = []  # Track all threads

def log_result(component, test_name, result, details=None):
    """Log a test result with thread safety"""
    with lock:
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        RESULTS.append({
            "timestamp": timestamp,
            "component": component,
            "test": test_name,
            "result": result,
            "details": details
        })
        status = "[\033[92mPASS\033[0m]" if result == "PASS" else (
                 "[\033[93mWARN\033[0m]" if result == "WARN" else (
                 "[\033[91mFAIL\033[0m]" if result == "FAIL" else "[\033[94mINFO\033[0m]"))
        print(f"{timestamp} {status} {component} - {test_name}", flush=True)
        if details:
            print(f"  Details: {details}", flush=True)
        sys.stdout.flush()

# Additional functions omitted for brevity
# See full script for complete implementation
```

## Blockchain Enabled Environment

```python
#!/usr/bin/env python3
"""
Docker Security Test Script for Blockchain & Fingerprinting Environment
----------------------------------------------------------------------
This script tests the security of a dockerized blockchain and fingerprinting environment.
Network: ics
Subnet: 172.20.0.0/16

Modified version with specific component testing for this environment
"""

import subprocess
import socket
import threading
import time
import sys
import os
import json
import traceback
from datetime import datetime

# Define the network components for the new environment
NETWORK_COMPONENTS = {
    "PLC1": {"name": "plc1-dsc", "ip": "172.20.0.9", "ports": [502, 44818]},
    "PLC2": {"name": "plc2-dsc", "ip": "172.20.0.5", "ports": [502, 44818]},
    "PLC3": {"name": "plc3-dsc", "ip": "172.20.0.6", "ports": [502, 44818]},
    "MQTT_Broker": {"name": "mqtt-broker-dsc", "ip": "172.20.0.8", "ports": [1883, 8883]},
    "InfluxDB": {"name": "influxdb-dsc", "ip": "172.20.0.7", "ports": [8086]},
    "Grafana": {"name": "grafana-dsc", "ip": "172.20.0.11", "ports": [3000]},
    "SCADA": {"name": "scada-dsc", "ip": "172.20.0.2", "ports": [80, 8080]},
    "Blockchain": {"name": "blockchain-dsc", "ip": "172.20.0.10", "ports": [1065]},
    "Fingerprinting": {"name": "fingerprinting-dsc", "ip": "172.20.0.3", "ports": [1066]},
    "Data_Populator": {"name": "populate-data-container-dsc", "ip": "172.20.0.4", "ports": []}
}

SUBNET = "172.20.0.0/16"
RESULTS = []
lock = threading.Lock()
threads = []  # Track all threads

def log_result(component, test_name, result, details=None):
    """Log a test result with thread safety"""
    with lock:
        timestamp = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        RESULTS.append({
            "timestamp": timestamp,
            "component": component,
            "test": test_name,
            "result": result,
            "details": details
        })
        status = "[\033[92mPASS\033[0m]" if result == "PASS" else (
                 "[\033[93mWARN\033[0m]" if result == "WARN" else (
                 "[\033[91mFAIL\033[0m]" if result == "FAIL" else "[\033[94mINFO\033[0m]"))
        print(f"{timestamp} {status} {component} - {test_name}", flush=True)
        if details:
            print(f"  Details: {details}", flush=True)
        sys.stdout.flush()

# Additional functions omitted for brevity
# See full script for complete implementation
```

